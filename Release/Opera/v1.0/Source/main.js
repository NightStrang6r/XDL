const debug=!1,moodleApi="https://dl.nure.ua/",XDLApi="https://leoitdev.ru/api/XDL/";let settings;async function Main(){settings=await getSettings(),log(">XDL: Settings loaded:"),log(settings);let e=obtainAuth();e&&e.session&&e.sesskey&&await saveAuth(e)}function log(e,t=!1){debug&&(t?console.error(e):console.log(e))}function obtainAuth(){let e,t;try{if(t=document.getElementsByClassName("logininfo")[0].lastElementChild.href.split("=")[1],e=getCookie("MoodleSession"),!t)return log(`>XDL: Failed to obtain sesskey. Sesskey: ${t}`),{session:e,sesskey:t};if(!e)return log(`>XDL: Failed to obtain session. Session: ${e}`),{session:e,sesskey:t};log(`>XDL: Successfully obtained auth: ${e}, ${t}`)}catch(e){log(`>XDL: Failed to obtain auth. Error: ${e}`)}return{session:e,sesskey:t}}function getSettings(){return new Promise(e=>{chrome.runtime.sendMessage({greeting:"getSettings"},t=>e(t.settings))})}function saveAuth(e){return new Promise(t=>{chrome.runtime.sendMessage({greeting:"saveAuth",auth:e},e=>t(e.farewell))})}function getCookie(e){let t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}log(">XDL: Main.js loading..."),Main(),log(">XDL: Main.js loaded.");